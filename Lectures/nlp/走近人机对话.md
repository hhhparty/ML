# 走近人机对话

> 这篇笔记，主要来源于中国计算机学会通信 第 13 卷  第9 期  2017 年 9 月

## 人机对话

> 来源：刘　挺　张伟男 哈尔滨工业大学 “人机对话”， 


学术界和工业界越来越重视人机对话。在研究上，大数据和深度学习共同推动了自然语言理解技术的发展，以阅读理解为代表的任务将自然语言理解引向深入。

对话管理经历了由规则到有指导学习再到强化学习的发展过程，自然语言生成则从模板生成、句子规划，发展为端到端的深度学习模型。在应用上，基于人机对话技术的产品层出不穷，人们耳熟能详的有苹果公司的 Siri、亚马逊的Echo音箱、微软的 Cortana、脸书的 M以及谷歌的 Allo等。同时，各大企业也纷纷研发或收购 AI平台，如微软研发的语言理解智能服务 (LUIS.AI)，如三星、脸书和谷歌分别收购了 Viv.ai、Wit.ai 和API.AI，如百度研发的 DuerOS 以及收购的 KITT.
AI。从各大企业对人机对话技术的高度重视来看，未来的竞争将会何等激烈。

总体上看，人机对话系统经历了语音助手、聊天机器人和面向场景的任务执行三个阶段。语音助手的典型代表是苹果设备中的 Siri。语音助手目前的各项技术尚未成熟，还达不到用户的期望值。如“听见了”但“听不懂”，以至于“严肃”用途失效“，调戏”方式盛行。同时，语音助手往往需要私密的环境。在这种情况下，文字交互反而更有优势，如果有图像交互界面的配合，效果更好。2014 年，微软发布了聊天机器人小冰，其特点是从实用化转向娱乐化，降低了用户期望值，直接采用文字沟通。虽然深度学习技术被充分运用，技术水平有所提高，但也面临对语境建模和对机器人自身建模的技术问题，以及如何保持用户活跃度等实际应用问题。因而，人机对话系统应用的总体趋势是通过聊天建立人与机器之间的信任，在聊天中对用户进行画像，进而满足后续的场景化任务执行需求。当前的主要问题是，在聊天时，如何能让机器人更像人，以及在场景化任务执行中如何做到高效的场景切换。


人机对话系统四个方面的功能:
- 即聊天
- 知识问答
- 任务执行
- 信息推荐，
- 还包括口语对话系统中的认知智能、特定情感的对话文本生成以及开放域和任务型对话系统的评价。


## 任务型与问答型对话系统中的语言理解技术

> 车万翔　张　宇 哈尔滨工业大学



在各种类型的对话系统中，私人助理是一种非常重要的类型。它是通过自然语言对话的方式，完成用户发出的指令类任务，或者回答一些常识知识，例如，天气查询、机票预定、知识问答等。有很多著名的科技公司涉猎这一类型的对话系统，如苹果Siri，微软小娜，谷歌助理 (Google Assistant)，百度度秘，讯飞 AIUI 等。


一个对话系统通常有三个关键模块：

- 语言理解 (Language Understanding)，指的是将用户面向机器说出的自然语言转换为语义表示；

- 对话管理 (Dialogue Management) ，根据语义表示、语义上下文、用户元信息等，找到合适的
执行动作；

- 语言生成 (Language Generation)，指根据具体的动作生成一句自然语言来。


### 语言理解

任务型对话系统的语言理解模块通常可以拆分为领域识别、意图识别、语义槽(slot) 填充等三个子任务。

例如，对于用户输入的语句 ：
> "查一下明天北京到上海的机票。"

![表1领域意图语义槽示例](images/201906/表1领域意图语义槽示例.png)

表 1 列出了这句话的领域、意图、语义槽，其中，“明天”的语义槽类型是出发时间，“北京”和“上海”
的语义槽类型分别是出发地和到达地。

知识问答型对话系统的语言理解模块通常指的是对问题进行分类，即为问题返回一个类别标签，该类别标签是问题期望答案的类别，如时间、地点等。

### 领域/意图与问题分类

领域/意图与问题分类任务型对话中的领域识别和意图识别，以及知识问答型对话系统中的问题分类通常都可以视为文本分类任务来解决。

其中，领域和意图的定义与对话系统自身的定位和所具有的知识库有很大关系，即具有非常强的领域相关性。而问题分类的类别通常相对通用，具有一定的领域无关性，如哈尔滨工业大学信息检索和社会计算研究中心提出的中文问题的分类体系，主要包括:

- 描述类 (DES)
- 人物类 (HUM)
- 地点类 (LOC)
- 数字类 (NUM)
- 时间类 (TIME)
- 实体类 (OBJ) 

６个大类，每个大类又划分为若干小类，共计 84 个小类（见表 2）。

![表2中文问题分类体系](images/201906/表2中文问题分类体系.png)

国内外学者已经对文本分类技术进行了大量的研究，基于深度学习的方法依然是目前的主流。Kalchbrenner 等人构建了一种动态卷积神经网络(DCNN)，对句子语义信息进行建模从而对文本进行分类，在 DCNN 中使用了一种全局 k-max 池化操作方法。Mou 等人利用依存句法树和成分树构建了一种基于树的卷积神经网络 (TBCNN)。TBCNN 利用最大池化方法融合了句子的结构特征及其他多种特征。Komninos 等人在神经网络模型中使用基于上下文的词嵌入特征。基于深度学习的方法可以自动抽取特征，在减少了工作量的同时，还可以抓
取到直觉上无法获取的特征，从而提高分类的精度。

### 语义槽填充

语义槽相当于意图中所涉及的关键信息，包含语义槽名称和语义槽值。语义槽名称如“出发地”，语义槽值为对应的具体实体内容，如“北京”。语义解析后，返回语义槽名称和语义槽值。

#### 任务介绍

语义槽填充任务的主要目标是在已知特定领域或意图的语义框架 (semantic frame) 的前提下，从输入语句中抽取出该语义框架中预先定义好的语义槽的值。语义槽填充任务可以转化为序列标注任务，即使用经典的 IOB标记法。用此标注法，“查一下明天北京到上海的机票”，标注结果为 ：

> IOB指的是一个词是某一语义槽的开始(begin)、延续(inside)或者非语义槽(outside)。

![查一下明天北京到上海的机票](images/201906/查一下明天北京到上海的机票.png)

#### 研究现状

**基于特征抽取的传统机器学习方法**

基于特征抽取的传统机器学习模型已经在语义槽填充任务上大量应用。例如，基于隐马尔科夫模型 (HMM) 或上下文无关文法 (CFG)，隐向量状
态 (HVS)等的生成模型，以及基于条件随机场(CRF)，支持向量机 (SVM)等的判别模型。

**基于深度学习的方法**

随着深度学习技术在自然语言领域的发展，基于深度学习的方法也广泛应用于语义槽填充任务。相比于传统的机器学习方法，深度学习模型不仅能够自动学习输入数据的隐含特征，同时也能够融入人工抽取的特征。

Yao 等人和 Mensil 等人最早将循环神经网络 (RNN) 应用于语义槽填充的任务上。之后双方总结了一篇使用 RNN 进行语言理解任务中语义槽填充的文章。文章将语义槽填充视为序列标注任务，对不同种类 RNN、双向 RNN、RNN-CRF 等网络结构的表现做了详细实验，结果表明，相对于CRF 的基线方法，这些模型结构能够获得更好的结果。Yao 等人使用了 LSTM 网络及相关变种，还有学者使用了 CNN 网络，Chen 等人使用了 Encoder-Decoder 的框架进行语义槽标签标注，并引入了注意力机制。

**意图识别-语义槽填充联合模型**

基于语言理解的工作流程 ：领域 / 意图识别、语义槽填充，相关工作默认已经获知了意图识别的结果，并在该意图的语义框架下进行语义槽填充。其中的问题是，如果领域 / 意图识别错误，会直接影响到语义槽填充任务，从而产生错误传播。为了解决这个问题，很多学者使用了领域 / 意图识别和语义槽填充的联合模型。其基本思想是使用一个网络结构学习输入的句子的信息，同时输出每个词的标签以及句子的领域、意图类别。

**引入外部知识**

一些工作考虑引入外部知识来提升模型性能。文献 [31, 32] 等引入了 Freebase或者 Wikipedia等外部知识来提升系统的性能。Chen 等人在Encoder-Decoder 框架下，引入依存句法分析、语义依存分析等先验知识在数据集较小的情况下能够显著提升模型效果。

### 数据集

ATIS数据集任务型对话语言理解的研究工作中，使用最广泛的数据集是航空旅游信息系统 (Airline Travel Information System, ATIS) 的数据。该数据集是采集自真实预订飞机票录音，再经过转写后的文本。ATIS 在语言理解任务上使用最广泛的版本是来自于 He 等人和 Raymond 等人的工作，其中训练数据共 4978 句，来自 ATIS22和 ATIS3数据
集 ；测试数据包含 893 句，来自 ATIS3 NOV93 和DEC94 数据集。其中包含了 127 种语义槽标签和 18种意图。

#### 其他数据集

在一些研究工作中，使用了非公开的数据集。例如 Guo 等人的工作中，使用了微软 Cortana 英文对话数据集。Yao 等人使用了微软必应查询 (Bing Query) 理解英文数据集。在 Luo 等人的工作中，使用了 Nuance 公司私有的数据集。这个数据集包含了 200 万句训练数据，26 万句测试数据，涵盖了 170 种意图。

### 对话系统服务平台

如果自己开发一个对话系统，通常需要完成以下工作。

1. 定义和准备 ：定义该对话系统支持的领域 /意图或问题类别，定义语义槽，进行相关的数据标注 ；
2. 训练和实现 ：训练领域 / 意图或问题分类模型，实现语言理解、对话管理和语言生成模块 ；
3. 部署 ：在自己的服务器上，部署实现好的工程，对用户提供服务。
   
在不同的对话系统中，由于领域不同，第一步的定义和数据标注通常会有区别 ；而第二步和第三步的工作往往是重复的，所以可以考虑将这两步抽象为一个通用工作流程，作为一个算法的黑箱，为开发者提供一个通用的对话系统服务平台。在该平台上，用户只需完成第一步的任务定义和数据标注工作，后面两个步骤由平台自动提供，因此极大地简化了对话系统的开发和部署流程。

各大互联网公司纷纷推出了各自的对话系统服务平台，如微软推出的 LUIS.AI，谷歌收购的 API.AI 和脸书收购的 Wit.ai 等。
